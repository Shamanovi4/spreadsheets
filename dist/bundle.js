(()=>{"use strict";var __webpack_modules__={584:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function parse(value=""){if(value.startsWith("="))try{return eval(value.slice(1))}catch(t){return value}return value}__webpack_require__.d(__webpack_exports__,{Q:()=>parse})}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var s in e)__webpack_require__.o(e,s)&&!__webpack_require__.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{class t{constructor(t){this.$el="string"==typeof t?document.querySelector(t):t}html(t){return"string"==typeof t?(this.$el.innerHTML=t,this):this.$el.outerHTML.trim()}clear(){return this.html(""),this}text(t){return"string"==typeof t||"number"==typeof t?(this.$el.textContent=t,this):"input"===this.$el.tagName.toLowerCase()?this.$el.value.trim():this.$el.textContent.trim()}append(e){e instanceof t&&(e=e.$el),Element.prototype.append?this.$el.append(e):this.$el.appendChild(e)}on(t,e){this.$el.addEventListener(t,e)}off(t,e){this.$el.removeEventListener(t,e)}closest(t){return e(this.$el.closest(t))}getCoords(){return this.$el.getBoundingClientRect()}getOffset(){return{top:this.$el.offsetTop,left:this.$el.offsetLeft}}getScroll(){return{top:this.$el.scrollTop,left:this.$el.scrollLeft}}get data(){return this.$el.dataset}findAll(t){return this.$el.querySelectorAll(t)}findDom(t){return e(this.$el.querySelector(t))}getPropertyValue(t,e,s){return window.getComputedStyle(t,s).getPropertyValue(e)}css(t={}){Object.keys(t).forEach((e=>{this.$el.style[e]=t[e]}))}getStyles(t=[]){return t.reduce(((t,e)=>(t[e]=this.$el.style[e],t)),{})}addClass(t){this.$el.classList.add(t)}removeClass(t){this.$el.classList.remove(t)}id(t){if(t){const t=this.id().split(":");return{row:+t[0],col:+t[1]}}return this.data.id}focus(){return this.$el.focus(),this}attribute(t,e){return e?(this.$el.setAttribute(t,e),this):this.$el.getAttribute(t)}}function e(e){return new t(e)}function s(){return e.create("div","loader").html('\n    <div class="lds-default">\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n    </div>\n  ')}e.create=(t,s="")=>{const n=document.createElement(t);return s&&n.classList.add(s),e(n)};class n{static get path(){return window.location.hash.slice(1)}static get param(){return n.path.split("/")[1]}static navigate(t){window.location.hash=t}}class i{constructor(t){this.params=t||Date.now().toString()}getRoot(){throw new Error('Method "getRoot" should be implemented')}afterRender(){}destroy(){}}function r(t,e=null){if(!e)return JSON.parse(localStorage.getItem(t));localStorage.setItem(t,JSON.stringify(e))}function a(t,e,s,n){return`\n  <${e} class="${s}" ${void 0===n?"":n}>\n    ${t}\n  </${e}>\n  `}function o(t,e){let s;return function(...n){clearTimeout(s),s=setTimeout((()=>{clearTimeout(s),t.apply(this,n)}),e)}}function l(t){t.preventDefault()}function c(t){const e=r(t);return`\n  <li class="dashboard__list__item">\n    <a class="dashboard__list__item__link" href="#spreadsheet/${t.split(":")[1]}">\n      <img src="favicon.ico" alt="Icon" class="dashboard__list__item__icon" />\n      <span class="dashboard__list__item__name">${e.tableTitle}</span>\n      <span class="dashboard__list__item__date">\n        ${new Date(e.lastOpenedDate).toLocaleDateString()}\n        ${new Date(e.lastOpenedDate).toLocaleTimeString()}\n      </span>\n    </a>\n  </li>\n  `}class d{constructor(){this.listeners={}}emit(t,...e){return!!Array.isArray(this.listeners[t])&&(this.listeners[t].forEach((t=>{t(...e)})),!0)}subscribe(t,e){return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),()=>{this.listeners[t]=this.listeners[t].filter((t=>t!==e))}}}class u{constructor(t){this.store=t,this.sub=null,this.prevState={}}subscribeComponents(t){this.prevState=this.store.getState(),this.sub=this.store.subscribe((e=>{Object.keys(e).forEach((s=>{var n,i;n=this.prevState[s],i=e[s],("object"==typeof n&&"object"==typeof i?JSON.stringify(n)===JSON.stringify(i):n===i)||t.forEach((t=>{if(t.isWatching(s)){const n={[s]:e[s]};t.storeChanged(n)}}))})),this.prevState=this.store.getState()}))}unsubscribeFromStore(){this.sub.unsubscribe()}}const h="TABLE_RESIZE",p="CHANGE_TEXT",f="APPLY_STYLE",m="CHANGE_STYLES",b="CHANGE_TITLE",_="UPDATE_DATE";class v{constructor(t){this.components=t.components||[],this.store=t.store,this.emitter=new d,this.subscriber=new u(this.store)}getRoot(){const t=e.create("div","spreadsheet"),s={emitter:this.emitter,store:this.store};return this.components=this.components.map((n=>{const i=e.create("div",n.className),r=new n(i,s);return i.html(r.toHTML()),t.append(i),r})),t}init(){this.store.dispatch({type:_}),this.subscriber.subscribeComponents(this.components),this.components.forEach((t=>t.init()))}destroy(){this.subscriber.unsubscribeFromStore(),this.components.forEach((t=>t.destroy())),document.removeEventListener("contextmenu",l)}}function g(t){return"on"+("string"!=typeof(e=t)?"":e.charAt(0).toUpperCase()+e.slice(1));var e}class y extends class{constructor(t,e=[]){if(!t)throw new Error("No $root provided for DomListener!");this.$root=t,this.listeners=e}initDOMListeners(){this.listeners.forEach((t=>{const e=g(t);if(!this[e]){const t=this.name;throw new Error(`Method ${e} is not implemented in ${t} component`)}this[e]=this[e].bind(this),this.$root.on(t,this[e])}))}removeDOMListeners(){this.listeners.forEach((t=>{const e=g(t);this[e]&&this.$root.off(t,this[e])}))}}{constructor(t,e={}){super(t,e.listeners),this.name=e.name||"",this.emitter=e.emitter,this.subscribe=e.subscribe||[],this.unsubscribers=[],this.store=e.store,this.storeSub=null,this.prepare()}prepare(){}toHTML(){return""}$emit(t,...e){this.emitter.emit(t,...e)}$on(t,e){const s=this.emitter.subscribe(t,e);this.unsubscribers.push(s)}$dispatch(t){this.store.dispatch(t)}storeChanged(){}isWatching(t){return this.subscribe.includes(t)}init(){this.initDOMListeners()}destroy(){this.removeDOMListeners(),this.unsubscribers.forEach((t=>t()))}}const w={justifyContent:"flex-start",fontWeight:"normal",textDecoration:"none",fontStyle:"normal",activeDropDown:"none"},$="New Table";class S extends y{constructor(t,e){super(t,{name:"Header",listeners:["input","click"],...e})}prepare(){this.onInput=o(this.onInput,250)}toHTML(){return`\n      <div class="spreadsheet__header__inner">\n        <a class="logo" href="#dashboard">\n          <img src="src/assets/images/logo.png" alt="Logo" />\n        </a>\n        <input class="title-input" type="text" value="${this.store.getState().tableTitle||$}">\n        <div class="control-panel">\n          <div class="button" data-button-type="delete">\n            <span class="material-icons"> delete </span>\n          </div>\n          <div class="button" data-button-type="exit">\n            <span class="material-icons"> exit_to_app </span>\n          </div>\n        </div>\n      </div>\n    `}onClick(t){const s=e(t.target);"delete"===s.data.buttonType?confirm("Do you want to delete this table?")&&(localStorage.removeItem("spreadsheet:"+n.param),n.navigate("")):"exit"===s.data.buttonType&&n.navigate("")}onInput(t){const s=e(t.target);var n;this.$dispatch((n=s.text(),{type:b,data:n}))}}var x,C,T;T="spreadsheet__header",(C="className")in(x=S)?Object.defineProperty(x,C,{value:T,enumerable:!0,configurable:!0,writable:!0}):x[C]=T;class D extends y{constructor(...t){super(...t)}get template(){return JSON.stringify(this.state,null,2)}initState(t={}){this.state={...t}}setState(t){this.state={...this.state,...t},this.$root.html(this.template)}}function E(t,e){return function(s){return`\n      <div \n        class="${t} ${s.active?"active":""}"\n        data-type="button"\n        ${e?'data-button-type="dropdown"':""}\n        data-value='${JSON.stringify(s.value)}'\n      >\n        <span class="material-icons"> ${s.icon} </span>\n        ${e?'<span class="material-icons"> arrow_drop_down </span>':""}\n      </div>\n    `}}function k(t){switch(t.justifyContent){case"flex-start":return"format_align_left";case"center":return"format_align_justify";case"flex-end":return"format_align_right"}}class O extends D{constructor(t,e){super(t,{name:"Toolbar",listeners:["click"],subscribe:["currentStyles"],...e})}prepare(){this.initState(w)}get template(){return function(t){const e=[{icon:"format_bold",active:"bold"===t.fontWeight,value:{fontWeight:"bold"===t.fontWeight?"normal":"bold"}},{icon:"format_italic",active:"italic"===t.fontStyle,value:{fontStyle:"italic"===t.fontStyle?"normal":"italic"}},{icon:"format_strikethrough",active:"underline"===t.textDecoration,value:{textDecoration:"underline"===t.textDecoration?"none":"underline"}},{icon:"format_align_left",active:"flex-start"===t.justifyContent,value:{justifyContent:"flex-start"}},{icon:"format_align_justify",active:"center"===t.justifyContent,value:{justifyContent:"center"}},{icon:"format_align_right",active:"flex-end"===t.justifyContent,value:{justifyContent:"flex-end"}},{icon:k(t),active:"justifyContent"===t.activeDropDown,value:{activeDropDown:"justifyContent"===t.activeDropDown?"none":"justifyContent"}}];let s=e.slice(0,3);s=s.map(E("button")).join(""),s=a(s,"div","edit-tool");let n=e.slice(3,6);n=n.map(E("button button--align")).join(""),n=a(n,"div","edit-tool--align\n      "+("justifyContent"===t.activeDropDown?"active":""),'data-type="drop-down-menu"');let i=e.slice(6,7);return i=i.map(E("button button--align",!0)),n=a(i+n,"div","edit-tool"),a(s+'\n  <span class="divider"></span>\n  '+n,"div","spreadsheet__toolbar__inner")}(this.state)}toHTML(){return this.template}storeChanged(t){this.setState(t.currentStyles)}onClick(t){const s=e(t.target);if("button"===s.data.type){const t=JSON.parse(s.data.value),e={...t,activeDropDown:"none"};"dropdown"===s.data.buttonType?this.setState(t):this.setState(e),"dropdown"===s.data.buttonType?this.$emit("toolbar:applyStyle",t):this.$emit("toolbar:applyStyle",e)}}}!function(t,e,s){e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s}(O,"className","spreadsheet__toolbar");class L extends y{constructor(t,e){super(t,{name:"Formula",listeners:["input","keydown"],subscribe:["currentText"],...e})}toHTML(){return'\n      <div class="spreadsheet__formula__inner">\n        <div class="formula__info"></div>\n        <span class="divider"></span>\n        <div class="formula__label">fx</div>\n        <span class="divider"></span>\n        <div \n        id="formula" class="formula__input"\n        contenteditable="true" spellcheck="false"\n        >\n        </div>\n      </div>\n    '}init(){super.init(),this.$formula=this.$root.findDom("#formula"),this.$on("table:select",(t=>{this.$formula.text(t.data.value)}))}storeChanged({currentText:t}){this.$formula.text(t)}onInput(t){this.$emit("formula:input",e(t.target).text())}onKeydown(t){["Enter","Tab"].includes(t.key)&&(t.preventDefault(),this.$emit("formula:done"))}}!function(t,e,s){e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s}(L,"className","spreadsheet__formula");var j=__webpack_require__(584);function N(t){return String.fromCharCode(65+t)}function A(t,e){return(t[N(e)]||100)+"px"}function P(t,e){return(t[e]||21)+"px"}function z(t,e){return function(s,n){const i=`${t}:${n+1}`,r=N(n),a=A(e.colState,n),o=e.dataState[i],l=function(t={}){return Object.keys(t).map((e=>{return`${s=e,s.replace(/([A-Z])/g,(t=>`-${t[0].toLowerCase()}`))}: ${t[e]}`;var s})).join("; ")}({...w,...e.stylesState[i]});return`\n      <div \n        class="cell" contenteditable \n        data-type="cell"\n        data-row="${t}" \n        data-col="${r}"\n        data-id="${i}"\n        data-value="${o||""}"\n        style="${l}; width: ${a}"\n      >\n      <span>${(0,j.Q)(o)||""}</span>\n      </div>\n    `}}function H({index:t,width:e}){const s=N(t);return`\n    <div \n      class="col--label" \n      data-type="resizable" \n      data-col="${s}"\n      style="width: ${e}"\n    >\n      ${s}\n      <div class="col__resize" data-resize="col"></div>\n      <div class="col__resize-line" data-resize-line="col"></div>\n    </div>\n  `}function I(t,e,s,n){return`\n    <div\n      class="${n}" \n      data-row="${e}"\n      ${"notation-row"===n?'data-type="notation-row"':""}\n      ${"notation-row"===n?"":`style="height: ${P(s,e)}"`}\n    >\n      ${"notation-row"===n?'<div class="selector"></div>':""}\n      ${t}\n    </div>\n  `}function R(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class M{constructor(){this.group=[],this.current=null,this.selection=null,this.labels={rows:[],cols:[]}}get selectedIds(){return this.group.map((t=>t.id()))}range(t,e){return t>e&&([e,t]=[t,e]),new Array(e-t+1).fill("").map(((e,s)=>t+s))}setClasses(t,e,s,n){const i=t.findDom(M.notationTypes.row),r=t.findDom(M.notationTypes.col);if(void 0===s||void 0===n){const t=i.findDom(`[data-col="${this.current.data.col}"]`),e=r.findDom(`[data-row="${this.current.data.row}"]`);this.labels.cols.push(t),this.labels.rows.push(e),t.addClass(M.className),e.addClass(M.className)}else{const t=n.map((t=>i.findDom(`[data-col="${N(t-1)}"]`))),e=s.map((t=>r.findDom(`[data-row="${t}"]`)));t.forEach((t=>this.labels.cols.push(t))),e.forEach((t=>this.labels.rows.push(t))),t.forEach((t=>t.addClass(M.className))),e.forEach((t=>t.addClass(M.className)))}this.current.focus().addClass(M.className)}selectionBordered(){this.selection.addClass(M.selectionClasses.bordered)}selectionHandler(t){document.onmousemove=s=>{const n=e(document.elementFromPoint(s.pageX,s.pageY));n.data.type===M.cell&&this.selectGroup(t,n)},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null,null!==this.selection&&this.selectionBordered()}}setSelectionCSS(t,e,s,n,i,r){this.selection.css({top:t+i.top-r.top+"px",left:n+i.left-r.left+"px",height:s-t+"px",width:e-n+"px"})}setSelection(t,e){const s=e.id(!0),n=this.current.id(!0),i=e.getCoords(),r=this.current.getCoords();this.selection=t.findDom(M.selectionType);const a=e.closest(M.scrollableType),o=e.closest(M.fixedType),l=e.closest(M.gridType),c=a.getScroll(),d={top:t.getOffset().top+o.getOffset().top,left:l.getOffset().left};this.selection.addClass(M.selectionClasses.active),s.row<=n.row&&s.col>=n.col?this.setSelectionCSS(i.top,i.right,r.bottom,r.left,c,d):s.row>=n.row&&s.col>=n.col?this.setSelectionCSS(r.top,i.right,i.bottom,r.left,c,d):s.row>=n.row&&s.col<=n.col?this.setSelectionCSS(r.top,r.right,i.bottom,i.left,c,d):s.row<=n.row&&s.col<=n.col&&this.setSelectionCSS(i.top,r.right,r.bottom,i.left,c,d)}select(t,e){this.current=e,this.clear(),this.group.push(e),this.setClasses(t,e)}selectGroup(t,e){const s=e.id(!0),n=this.current.id(!0),i=this.range(n.row,s.row),r=this.range(n.col,s.col),a=i.reduce(((t,e)=>(r.forEach((s=>t.push(`${e}:${s}`))),t)),[]).map((e=>t.findDom(`[data-id="${e}"]`)));this.clear(),this.setSelection(t,e),this.group=a,this.setClasses(t,e,i,r)}clear(){this.group.forEach((t=>t.removeClass(M.className))),this.group=[],this.labels.rows.forEach((t=>t.removeClass(M.className))),this.labels.rows=[],this.labels.cols.forEach((t=>t.removeClass(M.className))),this.labels.cols=[],null!==this.selection&&(this.selection.removeClass(M.selectionClasses.active),this.selection.removeClass(M.selectionClasses.bordered))}applyStyle(t){this.group.forEach((e=>e.css(t)))}}R(M,"className","selected"),R(M,"selectionType",'[data-type="selection"]'),R(M,"cell","cell"),R(M,"gridType",'[data-type="grid"]'),R(M,"scrollableType",'[data-type="scrollable"]'),R(M,"fixedType",'[data-type="fixed"]'),R(M,"selectionClasses",{active:"table-selection--active",bordered:"table-selection--bordered"}),R(M,"notationTypes",{row:'[data-type="notation-row"]',col:'[data-type="notation-col"]'});class J extends y{constructor(t,e){super(t,{name:"Table",listeners:["mousedown","keydown","input"],...e}),this.tableSize={rows:100,cols:26}}toHTML(){return function(t,e,s={}){const n=[],i=I(new Array(e).fill("").map(function(t){return function(e,s){return{index:s,width:A(t.colState,s)}}}(s)).map(H).join(""),"",{},"notation-row"),r=`\n    <div\n      class="notation-col"\n      data-type="notation-col"\n    >\n      ${new Array(t).fill("").map(function(t){return function(e,s){return{index:s,height:P(t.rowState,s)}}}(s)).map(function(t){return function(e,s){return`\n      <div\n        class="row row--label" \n        data-type="resizable" \n        data-row="${s+1}"\n        style="height: ${P(t.rowState,s+1)}"\n      >\n        ${s+1}\n        <div class="row__resize" data-resize="row"></div>\n        <div class="row__resize-line" data-resize-line="row"></div>\n      </div>\n    `}}(s)).join("")}\n    </div>\n  `;for(let i=1;i<=t;i++){const t=new Array(e).fill("").map(z(i,s)).join("");n.push(I(t,i,s.rowState,"row"))}let o=a('\n    <div class="table-selection" \n      data-type="selection"\n    >\n    </div>\n  '+n.join(""),"div","grid",'data-type="grid"');return o=a(r+o,"div","grid-scrollable-wrapper",'data-type="scrollable"'),o=a(o,"div","grid-fixed-container",'data-type="fixed"'),a(i+o,"div","spreadsheet__table__inner")}(this.tableSize.rows,this.tableSize.cols,this.store.getState())}prepare(){this.tableSelection=new M}init(){super.init(),this.selectCell(this.$root,this.$root.findDom('[data-id="1:1"')),this.$on("formula:input",(t=>{this.tableSelection.current.attribute("data-value",t).text((0,j.Q)(t)),this.updateTextInStore(t)})),this.$on("formula:done",(()=>{this.tableSelection.current.focus()})),this.$on("toolbar:applyStyle",(t=>{var e;this.tableSelection.applyStyle(t),this.$dispatch((e={value:t,ids:this.tableSelection.selectedIds},{type:f,data:e}))}))}selectCell(t,e){this.tableSelection.select(t,e),this.$emit("table:select",e);const s=e.getStyles(Object.keys(w));this.$dispatch({type:m,data:s})}async resizeTable(t){try{const s=await function(t,s){return new Promise((n=>{const i=e(s.target),r=i.closest('[data-type="resizable"]'),a=i.data.resize,o="col"===a?"":function(t,s){return e(t.target).closest(".spreadsheet__table").findDom(".grid").findDom(`[data-row="${s}"]`)}(s,r.data.row),l=r.getCoords();let c;const d=r.findDom(`[data-resize-line="${a}"]`),u=t.findAll(`[data-col="${r.data.col}"]`),h="col"===a?"min-width":"min-height",p=Number(r.getPropertyValue(r.$el,h).slice(0,-2));if("col"===a){const e=t.getPropertyValue(t.$el,"height");d.css({height:e})}document.onmousemove=t=>{if("col"===a){const e=t.pageX-l.right;c=l.width+e,c>=p&&(i.css({right:-e-5+"px"}),d.css({right:2-e+"px"}))}else{const e=t.pageY-l.bottom;c=l.height+e,c>=p&&(i.css({bottom:-e-5+"px"}),d.css({bottom:2-e+"px"}))}},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null,"col"===a?(c>=p?u.forEach((t=>t.style.width=c+"px")):u.forEach((t=>t.style.width=p+"px")),i.css({right:"-5px"}),d.css({right:"2px"})):(c>=p?(r.css({height:c+"px"}),o.css({height:c+"px"})):(r.css({height:p+"px"}),o.css({height:p+"px"})),i.css({bottom:"-5px"}),d.css({bottom:"2px"})),n({value:c>p?c:p,eventType:a,id:r.data[a]})}}))}(this.$root,t);this.$dispatch(function(t){return{type:h,data:t}}(s))}catch(t){console.warn("Resize error",t.message)}}onMousedown(t){!function(t){return t.target.dataset.resize}(t)?function(t){return"cell"===t.target.dataset.type}(t)&&(t.shiftKey?(this.tableSelection.selectGroup(this.$root,e(t.target)),this.tableSelection.selectionBordered()):(this.selectCell(this.$root,e(t.target)),this.tableSelection.selectionHandler(this.$root))):this.resizeTable(t)}onKeydown(t){const{key:e}=t;if(["Enter","Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e)&&!t.shiftKey){t.preventDefault();const s=this.tableSelection.current.id(!0),n=this.$root.findDom(function(t,{row:e,col:s},{rows:n,cols:i}){switch(t){case"Enter":e=e+1<n?e+1:n;break;case"Tab":s++;break;case"ArrowUp":e=e-1<1?1:e-1;break;case"ArrowDown":e=e+1<n?e+1:n;break;case"ArrowLeft":s=s-1<1?1:s-1;break;case"ArrowRight":s=s+1<i?s+1:i}return`[data-id="${e}:${s}"]`}(e,s,this.tableSize));this.selectCell(this.$root,n),this.$emit("table:select",n)}}updateTextInStore(t){var e;this.$dispatch((e={id:this.tableSelection.current.id(),value:t},{type:p,data:e}))}onInput(t){this.updateTextInStore(e(t.target).text())}}function q(t,e){let s,n;switch(e.type){case h:return s="col"===e.data.eventType?"colState":"rowState",{...t,[s]:W(t,s,e)};case p:return s="dataState",{...t,currentText:e.data.value,[s]:W(t,s,e)};case m:return{...t,currentStyles:e.data};case f:return s="stylesState",n=t[s]||{},e.data.ids.forEach((t=>{n[t]={...n[t],...e.data.value}})),{...t,[s]:n,currentStyles:{...t.currentStyles,...e.data.value}};case b:return{...t,tableTitle:e.data};case _:return{...t,lastOpenedDate:(new Date).toJSON()};default:return t}}function W(t,e,s){const n=t[e]||{};return n[s.data.id]=s.data.value,n}!function(t,e,s){e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s}(J,"className","spreadsheet__table");const G={tableTitle:$,rowState:{},colState:{},dataState:{},stylesState:{},currentText:"",currentStyles:w,lastOpenedDate:(new Date).toJSON()};class Y{constructor(t,e=250){this.client=t,this.listen=o(this.listen.bind(this),e)}listen(t){this.client.save(t)}get(){return this.client.get()}}class B{constructor(t){this.name="spreadsheet:"+t}save(t){return r(this.name,t),Promise.resolve()}get(){return new Promise((t=>{const e=r(this.name);setTimeout((()=>{t(e)}),1e3)}))}}new class{constructor(t,n){if(!t)throw new Error("Selector for Router is not provided");this.$placeholder=e(t),this.routes=n,this.loader=new s,this.page=null,this.changePageHandler=this.changePageHandler.bind(this),this.init()}init(){window.addEventListener("hashchange",this.changePageHandler),this.changePageHandler()}async changePageHandler(){this.page&&this.page.destroy(),this.$placeholder.clear().append(this.loader);const t=n.path.includes("spreadsheet")?this.routes.spreadsheet:this.routes.dashboard;this.page=new t(n.param);const e=await this.page.getRoot();this.$placeholder.clear().append(e),this.page.afterRender()}destroy(){window.removeEventListener("hashchange",this.changePageHandler)}}("#app",{dashboard:class extends i{getRoot(){const t=Date.now().toString();return e.create("div","dashboard").html(`\n      <div class="dashboard__header">\n        <div class="dashboard__header__logo">\n          <img src="src/assets/images/logo.png" alt="Logo" />\n        </div>\n        <span class="dashboard__header__title">Spreadsheets</span>\n      </div>\n      ${function(){const t=function(){const t=[];for(let e=0;e<localStorage.length;e++){const s=localStorage.key(e);s.includes("spreadsheet")&&t.push(s)}return t}();return t.length?`\n  <div class="dashboard__list">\n    <ul class="dashboard__list__inner">\n      ${t.map(c).join("")}\n    </ul>\n  </div>\n  `:'\n    <p class="no-spreadsheets">You have no spreadsheets.</p>\n    '}()}\n      <div class="dashboard__create">\n        <a class="dashboard__create__button" href="#spreadsheet/${t}"></a>\n      </div>\n    `)}},spreadsheet:class extends i{constructor(t){super(t),this.storeSub=null,this.processor=new Y(new B(this.params))}async getRoot(){const t=function(t,e={}){let s=t({...e},{type:"__INIT__"}),n=[];return{subscribe:t=>(n.push(t),{unsubscribe(){n=n.filter((e=>e!==t))}}),dispatch(e){s=t(s,e),n.forEach((t=>t(s)))},getState:()=>JSON.parse(JSON.stringify(s))}}(q,(e=await this.processor.get())?(t=>({...t,currentStyles:w,currentText:""}))(e):function(t){return JSON.parse(JSON.stringify(t))}(G));var e;return this.storeSub=t.subscribe(this.processor.listen),this.spreadsheet=new v({components:[S,O,L,J],store:t}),this.spreadsheet.getRoot()}afterRender(){this.spreadsheet.init()}destroy(){this.spreadsheet.destroy(),this.storeSub.unsubscribe()}}})})()})();
//# sourceMappingURL=bundle.js.map